{namespace rkwBasics=RKW\RkwBasics\ViewHelpers}

<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" data-namespace-typo3-fluid="true">

    <f:if condition="{file}">
        <!-- Responsive Images v2.0 -->
        <picture{f:if(condition:'{additionalAttributes}', then: ' {additionalAttributes -> f:format.raw()}', else: ' {settings.additionalAttributes -> f:format.raw()}')}>
            <f:render section="SrcSet" arguments="{file: '{file}', isReference: '{f:if(condition: \'{treatIdAsReference}\', then: \'1\', else: \'0\')}', maxWidth: '{settings.maxWidth.desktop}', breakpoint: '{settings.breakpoint.desktop}', cropVariant: '{settings.cropVariant.desktop}'}" />
            <f:render section="SrcSet" arguments="{file: '{file}', isReference: '{f:if(condition: \'{treatIdAsReference}\', then: \'1\', else: \'0\')}', maxWidth: '{settings.maxWidth.tablet}', breakpoint: '{settings.breakpoint.tablet}', cropVariant: '{settings.cropVariant.tablet}'}" />
            <f:render section="SrcSet" arguments="{file: '{file}', isReference: '{f:if(condition: \'{treatIdAsReference}\', then: \'1\', else: \'0\')}', maxWidth: '{settings.maxWidth.mobile2}', breakpoint: '{settings.breakpoint.mobile2}', cropVariant: '{settings.cropVariant.mobile2}'}" />
            <f:render section="SrcSet" arguments="{file: '{file}', isReference: '{f:if(condition: \'{treatIdAsReference}\', then: \'1\', else: \'0\')}', maxWidth: '{settings.maxWidth.mobile}', breakpoint: '{settings.breakpoint.mobile}', cropVariant: '{settings.cropVariant.mobile}'}" />
            <f:render section="Fallback" arguments="{file: '{file}', isReference: '{f:if(condition: \'{treatIdAsReference}\', then: \'1\', else: \'0\')}', maxWidth: '{settings.maxWidth.fallback}', breakpoint: '0', cropVariant: '{settings.cropVariant.fallback}', title: '{f:if(condition:\'{title}\', then: \'{title}\', else: \' {settings.titleFallback}\')}'}" />
        </picture>
    </f:if>


    <f:section name="SrcSet">
        <f:if condition="{breakpoint}">
            <!-- maxWidth: {maxWidth}, breakPoint: {breakpoint} -->
            <f:render section="Retina" arguments="{_ALL}" />
            <f:render section="Regular" arguments="{_ALL}" />
        </f:if>
    </f:section>


    <f:section name="Fallback">
        <!-- maxWidth: {maxWidth}, breakPoint: {breakpoint} -->
        <f:render section="Retina" arguments="{_ALL}" />
        <img src="data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=" alt="{title->rkwBasics:format.trim()}" srcset="{f:uri.image(src:'{file}', treatIdAsReference:'{isReference}', maxWidth:'{maxWidth}', cropVariant:'{cropVariant}')}" />
    </f:section>


    <f:section name="Retina">
        <source srcset="{f:uri.image(src:'{file}', treatIdAsReference:'{isReference}', maxWidth:'{rkwBasics:responsiveImageCalc(maxValue:\'{maxWidth}\', resolution:\'2\')}', cropVariant:'{cropVariant}')}" media="(min-width: {breakpoint}px) AND (min-resolution: 192dpi)" />
    </f:section>


    <f:section name="Regular">
        <source srcset="{f:uri.image(src:'{file}', treatIdAsReference:'{isReference}', maxWidth:'{maxWidth}', cropVariant:'{cropVariant}')}" media="(min-width: {breakpoint}px)" />
    </f:section>

</html>